<mvc:View
    controllerName="mdq.re.controller.Rule"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:uxap="sap.uxap"
    xmlns:m="sap.m"
    xmlns:f="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
    displayBlock="true">
    
    <uxap:ObjectPageLayout
        id="objectPageLayout"
        upperCaseAnchorBar="false"
        enableLazyLoading="false">
        
        <uxap:headerTitle>
            <uxap:ObjectPageDynamicHeaderTitle id="header">
                <uxap:expandedHeading>
                    <m:Title id="headerTitle" text="{name}" wrapping="true"/>
                </uxap:expandedHeading>
                <uxap:snappedHeading>
                    <m:FlexBox id="flexbox" fitContainer="true" alignItems="Center">
                        <m:Title id="snappedTitle" text="{name}" wrapping="true"/>
                    </m:FlexBox>
                </uxap:snappedHeading>
                <uxap:expandedContent>
					<m:Text id="descTitle" text="{description}"/>
				</uxap:expandedContent>
				<uxap:snappedContent>
					<m:Text id="descTitleSnapped" text="{description}"/>
				</uxap:snappedContent>

                <uxap:actions>
                    <m:Button
                        id="editButton"
                        text="Edit"
                        type="Emphasized"
                        press="onEdit"
                        visible="{= !${viewState>/editMode} }"/>
                    <m:Button
                        id="saveButton"
                        text="Save"
                        type="Emphasized"
                        press="onSave"
                        visible="{viewState>/editMode}"/>
                    <m:Button
                        id="cancelButton"
                        text="Cancel"
                        press="onCancel"
                        visible="{viewState>/editMode}"/>
                    <m:Button
                        id="deleteButton"
                        text="Delete"
                        type="Transparent"
                        press="onDelete"
                        visible="{= !${viewState>/editMode} }"/>
                    <m:Button
                        id="closeButton"
                        icon="sap-icon://decline" 
                        type="Transparent"
                        press="onNavBack"
                        visible="{= !${viewState>/editMode} }"/>
                </uxap:actions>
            </uxap:ObjectPageDynamicHeaderTitle>
        </uxap:headerTitle>
        
        <uxap:headerContent>
            <m:FlexBox 
                id="headeritems"
                direction="Row" 
                alignItems="Center" 
                justifyContent="SpaceBetween" 
                >
                
            <m:FlexBox id="flexbox1" direction="Column" class="sapUiMediumMargin">
                <m:Label id="ruleIdLabel" text="Rule ID:" class="sapUiTinyMarginBottom"/>
                <m:Text id="ruleIdText" text="{ID}"/>
            </m:FlexBox>
            <m:FlexBox id="flexbox3" direction="Column" class="sapUiMediumMargin">
                <m:Label id="priorityLabel" text="Priority:" class="sapUiTinyMarginBottom"/>
                <m:Text id="priorityText" text="{priority}"/>
            </m:FlexBox>
            <m:FlexBox id="flexbox4" direction="Column" class="sapUiMediumMargin">
                <m:Label id="createdAtLabel" text="Created:" class="sapUiTinyMarginBottom"/>
                <m:Text id="createdAtText" text="{createdAt}"/>
            </m:FlexBox>
            </m:FlexBox>
        </uxap:headerContent>
        
        <uxap:sections>
            
            <uxap:ObjectPageSection
                id="generalSection"
                title="General">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection id="generalSubSection">
                        <uxap:blocks>
                            <f:SimpleForm
                                id="generalForm"
                                editable="false"
                                layout="ResponsiveGridLayout"
                                labelSpanXL="3"
                                labelSpanL="3"
                                labelSpanM="3"
                                labelSpanS="12"
                                adjustLabelSpan="false"
                                emptySpanXL="4"
                                emptySpanL="4"
                                emptySpanM="4"
                                emptySpanS="0"
                                columnsXL="1"
                                columnsL="1"
                                columnsM="1"
                                singleContainerFullSize="false">
                                
                                <f:content>
                                    
                                    <m:Label id="nameLabel" text="Name" required="true"/>
                                    <m:Input
                                        id="nameInput"
                                        value="{name}"
                                        editable="{viewState>/editMode}"/>
                                    
                                    <m:Label id="descriptionLabel" text="Description"/>
                                    <m:Input
                                        id="descriptionInput"
                                        value="{description}"
                                        editable="{viewState>/editMode}"/>

                                    <m:Label id="serviceLabel" text="Service Name"/>
                                    <m:Input
                                        id="serviceInput"
                                        value="{entity_service_name}"
                                        editable="{viewState>/editMode}"/>
                                    
                                    <m:Label id="targetEntityFormLabel" text="Target Entity" required="true"/>
                                    <m:Input
                                        id="targetEntityInput"
                                        value="{entity_name}"
                                        editable="{viewState>/editMode}"
                                        showValueHelp="true"
                                        valueHelpOnly="true"
                                        valueHelpRequest="handleValueHelp"/>

                                    <m:Label id="binaryOperatorLabel" text="Binary Operator"/>
                                    <m:Select
                                        id="binaryConditionSelect"
                                        selectedKey="{/conditionAndBinaryOperator}"
                                        editable="{viewState>/editMode}">
                                        <core:Item id="and" key="true" text="And"/>
                                        <core:Item id="or" key="false" text="Or"/>
                                    </m:Select>
                                    
                                    <m:Label id="priorityFormLabel" text="Priority"/>
                                    <m:Select
                                        id="prioritySelect"
                                        selectedKey="{priority}"   
                                        editable="{viewState>/editMode}">
                                        <core:Item id="high" key="High" text="High"/>
                                        <core:Item id="medium" key="Medium" text="Medium"/>
                                        <core:Item id="low" key="Low" text="Low"/>
                                    </m:Select>

                                </f:content>
                            </f:SimpleForm>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            
            <uxap:ObjectPageSection
                id="conditionsSection"
                title="Conditions">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection id="conditionsSubSection">
                        <uxap:blocks>
                            <m:Panel id="conditionsPanel">
                                <m:headerToolbar>
                                    <m:Toolbar id="conditionsToolbar">
                                        <m:Title id="conditionsTitle" text="Rule Conditions" level="H4"/>
                                        <m:ToolbarSpacer id="spacer2"/>
                                        <m:Button
                                            id="addConditionButton"
                                            text="Add Condition"
                                            type="Transparent"
                                            icon="sap-icon://add"
                                            press="onAddCondition"
                                            visible="{viewState>/editMode}"/>
                                    </m:Toolbar>
                                </m:headerToolbar>
                                <m:content>
                                    <m:Table
                                        id="conditionsTable"
                                        items="{
                                            path: 'Conditions'
                                            }"
                                        mode="None"
                                        delete="onDeleteCondition">
                                        <m:columns>
                                            <m:Column id="column1" width="50%">
                                                <m:Text id="fieldText" text="Field Name"/>
                                            </m:Column>
                                            <m:Column id="column2">
                                                <m:Text id="operatorText" text="Operator"/>
                                            </m:Column>
                                            <m:Column id="column3" width="25%">
                                                <m:Text id="valueText" text="Value"/>
                                            </m:Column>
                                        </m:columns>
                                        <m:items>
                                            <m:ColumnListItem id="items">
                                                <m:cells>
                                                    <m:Input
                                                        id="fieldInput"
                                                        value="{attribute_name}"
                                                        editable="{viewState>/editMode}"
                                                        showValueHelp="true"
                                                        valueHelpOnly="true"
                                                        valueHelpRequest="handleFieldValueHelp"/>
                                                    <m:Select
                                                        id="operatorInput"
                                                        selectedKey="{operator}"
                                                        editable="{viewState>/editMode}">
                                                        <core:Item id="equal" key="=" text="Equals (=)"/>
                                                        <core:Item id="greater" key=">" text="Greater than (>)"/>
                                                        <core:Item id="less" key="&lt;" text="Less than (&lt;)"/>
                                                        <core:Item id="contains" key="contains" text="Contains"/>
                                                        <core:Item id="starts" key="startswith" text="Starts with"/>
                                                    </m:Select>
                                                    <m:Input
                                                        id="valueInput"
                                                        value="{value}"
                                                        editable="{viewState>/editMode}"/>
                                                </m:cells>
                                            </m:ColumnListItem>
                                        </m:items>
                                    </m:Table>
                                </m:content>
                            </m:Panel>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>

            <uxap:ObjectPageSection
                id="actionsSection"
                title="Actions">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection id="actionsSubSection">
                        <uxap:blocks>
                            <m:Panel id="actionsPanel">
                                <m:headerToolbar>
                                    <m:Toolbar id="actionsToolbar">
                                        <m:Title id="actionsTitle" text="Rule Actions" level="H4"/>
                                        <m:ToolbarSpacer id="spacer1"/>
                                        <m:Button
                                            id="addActionButton"
                                            text="Add Action"
                                            type="Transparent"
                                            icon="sap-icon://add"
                                            press="onAddCondition"
                                            visible="{viewState>/editMode}"/>
                                    </m:Toolbar>
                                </m:headerToolbar>
                                <m:content>
                                    <m:Table
                                        id="actionsTable"
                                        items="{
                                            path: 'Actions'
                                            }"
                                        mode="None"
                                        delete="onDeleteAction">
                                        <m:columns>
                                            <m:Column id="column11" width="50%">
                                                <m:Text id="fieldText1" text="Field Name"/>
                                            </m:Column>
                                            <m:Column id="column22">
                                                <m:Text id="operatorText1" text="Operator"/>
                                            </m:Column>
                                            <m:Column id="column33">
                                                <m:Text id="valueText1" text="Value"/>
                                            </m:Column>
                                        </m:columns>
                                        <m:items>
                                            <m:ColumnListItem id="items1">
                                                <m:cells>
                                                    <m:Input
                                                        id="fieldInput1"
                                                        value="{attribute_name}"
                                                        editable="{viewState>/editMode}"
                                                        showValueHelp="true"
                                                        valueHelpOnly="true"
                                                        valueHelpRequest="handleFieldValueHelp"/>
                                                    <m:Select
                                                        id="operatorInput1"
                                                        selectedKey="{operator}"
                                                        editable="{viewState>/editMode}">
                                                        <core:Item id="equal1" key="=" text="Equals (=)"/>
                                                        <core:Item id="greater1" key=">" text="Greater than (>)"/>
                                                        <core:Item id="less1" key="&lt;" text="Less than (&lt;)"/>
                                                        <core:Item id="contains1" key="contains" text="Contains"/>
                                                        <core:Item id="starts1" key="startswith" text="Starts with"/>
                                                    </m:Select>
                                                    <m:Input
                                                        id="valueInput1"
                                                        value="{value}"
                                                        editable="{viewState>/editMode}"/>
                                                </m:cells>
                                            </m:ColumnListItem>
                                        </m:items>
                                    </m:Table>
                                </m:content>
                            </m:Panel>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>

            
        </uxap:sections>
        
    </uxap:ObjectPageLayout>
    
</mvc:View>